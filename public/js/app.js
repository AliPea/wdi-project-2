"use strict";var Outdoorsy=Outdoorsy||{};Outdoorsy.api_url="http://localhost:3000/api",Outdoorsy.init=function(){this.apiUrl="http://localhost:3000/api",this.mapSetup(),this.eventListeners(),this.getToken()?this.loggedInState():this.loggedOutState()},Outdoorsy.eventListeners=function(){$("main").on("submit",".modal form",this.handleForm),$(".logout").on("click",this.logout.bind(this))},Outdoorsy.handleForm=function(){console.log("working"),event.preventDefault();var e=""+Outdoorsy.apiUrl+$(this).attr("action"),t=$(this).attr("method"),o=$(this).serialize();return $(".modal").modal("hide"),Outdoorsy.ajaxRequest(e,t,o,function(e){e.token&&Outdoorsy.setToken(e.token),Outdoorsy.loggedInState()})},Outdoorsy.ajaxRequest=function(e,t,o,n){return $.ajax({url:e,method:t,data:o,beforeSend:this.setRequestHeader.bind(this)}).done(n).fail(function(e){console.log(e)})},Outdoorsy.logout=function(){event.preventDefault(),this.removeToken(),this.loggedOutState()},Outdoorsy.setRequestHeader=function(e,t){return e.setRequestHeader("Authorization","Bearer "+this.getToken())},Outdoorsy.setToken=function(e){return window.localStorage.setItem("token",e)},Outdoorsy.getToken=function(){return window.localStorage.getItem("token")},Outdoorsy.removeToken=function(){return window.localStorage.clear()},Outdoorsy.loggedInState=function(){$(".loggedOut").hide(),$(".loggedIn").show()},Outdoorsy.loggedOutState=function(){$(".loggedOut").show(),$(".loggedIn").hide()},Outdoorsy.mapSetup=function(){var e=document.getElementById("map-canvas");console.log(e);var t={zoom:13,center:new google.maps.LatLng(51.506178,(-.088369)),mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[{featureType:"water",elementType:"geometry",stylers:[{color:"#e9e9e9"},{lightness:17}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:20}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffffff"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#ffffff"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:16}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:21}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#dedede"},{lightness:21}]},{elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"},{lightness:16}]},{elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#333333"},{lightness:40}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#f2f2f2"},{lightness:19}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#fefefe"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#fefefe"},{lightness:17},{weight:1.2}]}]};this.map=new google.maps.Map(e,t),this.getActivities()},Outdoorsy.getActivities=function(){return $.get(this.api_url+"/activities").done(this.loopThroughActivities.bind(this))},Outdoorsy.loopThroughActivities=function(e){return $.each(e.activities,this.createMarkerForActivity.bind(this))},Outdoorsy.createMarkerForActivity=function(e,t){var o=new google.maps.LatLng(t.lat,t.lng),n={url:"/images/badge.png",scaledSize:new google.maps.Size(34.95,40),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},i=new google.maps.Marker({position:o,map:this.map,icon:n});this.addInfoWindowForActivity(t,i)},Outdoorsy.addInfoWindowForActivity=function(e,t){var o=this;google.maps.event.addListener(t,"click",function(){"undefined"!=typeof o.infowindow&&o.infowindow.close(),o.infowindow=new google.maps.InfoWindow({content:'\n      <div class="info">\n      <img src="'+e.image+'">\n      <h3>'+e.name+"</h3>\n      <p>"+e.description+"</p>\n      </div>\n      "}),o.infowindow.open(o.map,t),o.map.setCenter(t.getPosition())})},$(Outdoorsy.init.bind(Outdoorsy));